<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b1220" />
  <title>PantryPilot AI ‚Äî Personalized Recipe + Nutrition Guidance</title>
  <style>
    :root{
      --bg:#0b1220;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.09);
      --border:rgba(255,255,255,.10);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.75);
      --faint:rgba(234,240,255,.55);
      --brand1:#7c3aed;
      --brand2:#22c55e;
      --brand3:#06b6d4;
      --warn:#fbbf24;
      --bad:#fb7185;
      --good:#34d399;
      --shadow: 0 22px 60px rgba(0,0,0,.45);
      --radius: 18px;
      --radius2: 24px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }

    /* Light mode */
    [data-theme="light"]{
      --bg:#f6f8ff;
      --panel:rgba(15,23,42,.05);
      --panel2:rgba(15,23,42,.08);
      --border:rgba(15,23,42,.12);
      --text:#0b1220;
      --muted:rgba(11,18,32,.75);
      --faint:rgba(11,18,32,.55);
      --shadow: 0 18px 50px rgba(15,23,42,.12);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(124,58,237,.35), transparent 55%),
        radial-gradient(900px 500px at 85% 20%, rgba(34,197,94,.28), transparent 55%),
        radial-gradient(900px 500px at 60% 95%, rgba(6,182,212,.20), transparent 55%),
        var(--bg);
      overflow-x:hidden;
    }
    a{ color:inherit; text-decoration:none; }
    .wrap{
      width:min(1180px, calc(100% - 40px));
      margin:0 auto;
      padding:28px 0 64px;
    }

    /* Top bar */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      position:sticky;
      top:0;
      padding:14px 0;
      backdrop-filter: blur(10px);
      z-index:10;
    }
    .topbar::before{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(to bottom, rgba(0,0,0,.30), transparent);
      opacity:.35;
      pointer-events:none;
    }
    [data-theme="light"] .topbar::before{
      background: linear-gradient(to bottom, rgba(255,255,255,.85), transparent);
      opacity:1;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      position:relative;
      z-index:1;
    }
    .logo{
      width:42px;height:42px;border-radius:14px;
      background:
        radial-gradient(18px 18px at 30% 30%, rgba(255,255,255,.55), transparent 60%),
        linear-gradient(135deg, var(--brand1), var(--brand3));
      box-shadow: 0 18px 40px rgba(124,58,237,.25);
      border:1px solid rgba(255,255,255,.10);
    }
    [data-theme="light"] .logo{ border:1px solid rgba(15,23,42,.10); }
    .brand h1{
      font-size:15px;
      margin:0;
      letter-spacing:.3px;
      line-height:1.15;
    }
    .brand small{
      display:block;
      margin-top:2px;
      color:var(--muted);
      font-weight:500;
      font-size:12px;
    }
    .actions{
      display:flex;
      align-items:center;
      gap:10px;
      position:relative;
      z-index:1;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background: var(--panel);
      box-shadow: var(--shadow);
      font-size:13px;
      color:var(--muted);
      user-select:none;
    }
    .btn{
      appearance:none;
      border:1px solid var(--border);
      background: var(--panel);
      color:var(--text);
      padding:10px 12px;
      border-radius:999px;
      cursor:pointer;
      font-weight:650;
      letter-spacing:.2px;
      display:inline-flex;
      align-items:center;
      gap:10px;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
    }
    .btn:hover{ background: var(--panel2); border-color: rgba(255,255,255,.18); }
    [data-theme="light"] .btn:hover{ border-color: rgba(15,23,42,.18); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      background: linear-gradient(135deg, rgba(124,58,237,.95), rgba(6,182,212,.85));
      border-color: rgba(255,255,255,.20);
      box-shadow: 0 18px 46px rgba(124,58,237,.20);
    }
    .btn.primary:hover{ filter:saturate(1.05) brightness(1.05); }
    .btn .dot{
      width:9px;height:9px;border-radius:99px;background:var(--good);
      box-shadow:0 0 0 6px rgba(52,211,153,.12);
    }

    /* Hero */
    .hero{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:18px;
      margin-top:18px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .hero{ grid-template-columns: 1fr; }
    }
    .card{
      border:1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,.03));
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .card .pad{ padding:22px; }
    .hero h2{
      font-size:44px;
      line-height:1.03;
      margin:0 0 10px;
      letter-spacing:-.8px;
    }
    @media (max-width: 540px){
      .hero h2{ font-size:36px; }
    }
    .subtitle{
      margin:0 0 16px;
      color:var(--muted);
      font-size:15px;
      line-height:1.6;
      max-width: 62ch;
    }
    .kpis{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-top:18px;
    }
    @media (max-width: 560px){
      .kpis{ grid-template-columns: 1fr; }
    }
    .kpi{
      border:1px solid var(--border);
      border-radius: 16px;
      padding:12px 12px 10px;
      background: rgba(255,255,255,.04);
    }
    [data-theme="light"] .kpi{ background: rgba(15,23,42,.03); }
    .kpi b{
      display:block;
      font-size:14px;
      margin-bottom:4px;
    }
    .kpi span{
      color:var(--muted);
      font-size:12px;
      line-height:1.35;
      display:block;
    }
    .pillrow{
      display:flex;flex-wrap:wrap;gap:8px;margin-top:14px;
    }
    .pill{
      font-size:12px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color:var(--muted);
      display:inline-flex;
      gap:8px;
      align-items:center;
    }
    [data-theme="light"] .pill{ background: rgba(15,23,42,.03); }

    /* Generator */
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1.15fr;
      gap:18px;
      margin-top:18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid2{ grid-template-columns: 1fr; }
    }
    .section-title{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:16px;
      margin: 26px 0 10px;
    }
    .section-title h3{
      margin:0;
      font-size:18px;
      letter-spacing:.2px;
    }
    .section-title p{
      margin:0;
      color:var(--muted);
      font-size:13px;
      max-width: 70ch;
      line-height:1.5;
    }
    .form{
      display:grid;
      gap:12px;
    }
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width: 560px){
      .row{ grid-template-columns: 1fr; }
    }
    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin: 0 0 6px;
    }
    input,select,textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--text);
      outline:none;
      transition: border-color .2s ease, background .2s ease;
      font-size:14px;
    }
    [data-theme="light"] input,[data-theme="light"] select,[data-theme="light"] textarea{
      background: rgba(15,23,42,.03);
    }
    textarea{ min-height:88px; resize:vertical; }
    input:focus,select:focus,textarea:focus{
      border-color: rgba(6,182,212,.55);
      background: rgba(6,182,212,.06);
    }
    .hint{
      font-size:12px;
      color:var(--faint);
      margin-top:6px;
      line-height:1.35;
    }
    .divider{
      height:1px;
      background: var(--border);
      margin: 14px 0;
    }

    /* Output */
    .recipe{
      display:grid;
      gap:12px;
    }
    .recipe-header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .recipe-title{
      margin:0;
      font-size:22px;
      letter-spacing:-.3px;
      line-height:1.2;
    }
    .badge{
      font-size:12px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      white-space:nowrap;
      display:inline-flex;
      gap:8px;
      align-items:center;
    }
    .badge strong{ color: var(--text); }
    .meta{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:8px;
    }
    .cols{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 560px){
      .cols{ grid-template-columns: 1fr; }
    }
    .box{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      border-radius: 18px;
      padding:14px;
    }
    [data-theme="light"] .box{ background: rgba(15,23,42,.03); }
    .box h4{
      margin:0 0 10px;
      font-size:13px;
      color:var(--muted);
      font-weight:750;
      letter-spacing:.2px;
      text-transform:uppercase;
    }
    ul,ol{ margin:0; padding-left: 18px; color:var(--text); }
    li{ margin: 6px 0; color: var(--muted); line-height:1.45; }
    li b{ color:var(--text); }
    .note{
      font-size:12px;
      color: var(--faint);
      line-height:1.45;
      margin-top:10px;
    }

    /* Calibration */
    .calib{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top: 10px;
    }
    .calib-left{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .seg{
      display:flex;
      border:1px solid var(--border);
      border-radius:999px;
      overflow:hidden;
      background: rgba(255,255,255,.03);
    }
    [data-theme="light"] .seg{ background: rgba(15,23,42,.03); }
    .seg button{
      border:0;
      background:transparent;
      color:var(--muted);
      padding:10px 12px;
      cursor:pointer;
      font-weight:700;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .seg button.active{
      background: rgba(6,182,212,.16);
      color: var(--text);
    }
    .toast{
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(10,16,28,.85);
      border:1px solid rgba(255,255,255,.12);
      color: var(--text);
      padding: 12px 14px;
      border-radius: 14px;
      box-shadow: var(--shadow);
      font-size: 13px;
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s ease, transform .25s ease;
      max-width: min(680px, calc(100% - 24px));
      backdrop-filter: blur(12px);
      z-index: 50;
    }
    [data-theme="light"] .toast{
      background: rgba(255,255,255,.90);
      border:1px solid rgba(15,23,42,.12);
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }

    /* Footer / references */
    .refs a{ text-decoration: underline; text-decoration-color: rgba(255,255,255,.35); }
    [data-theme="light"] .refs a{ text-decoration-color: rgba(15,23,42,.35); }
    .mini{
      font-family: var(--mono);
      font-size: 12px;
      color: var(--faint);
    }
  </style>
</head>
<body>
  <div class="wrap" id="top">
    <div class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>PantryPilot AI</h1>
          <small>Generative AI for Personalized Recipe Creation & Nutrition Guidance</small>
        </div>
      </div>
      <div class="actions">
        <div class="chip" title="Runs locally in your browser">
          <span class="dot" aria-hidden="true"></span> Offline Demo ‚Ä¢ Fast
        </div>
        <button class="btn" id="themeBtn" aria-label="Toggle theme">üåó Theme</button>
        <a class="btn primary" href="#demo">‚ú® Try the AI</a>
      </div>
    </div>

    <!-- HERO -->
    <section class="hero">
      <div class="card">
        <div class="pad">
          <h2>Cook smarter, not harder ‚Äî powered by AI.</h2>
          <p class="subtitle">
            A pantry-aware kitchen companion that creates recipes from what you already have,
            respects dietary restrictions & cultural preferences, and balances nutrition with taste. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)
          </p>

          <div class="pillrow" aria-label="Key themes">
            <div class="pill">ü•ó Nutrition goals</div>
            <div class="pill">üß∫ Pantry-first</div>
            <div class="pill">üåç Cultural authenticity</div>
            <div class="pill">‚ôªÔ∏è Reduce food waste</div>
            <div class="pill">‚è±Ô∏è Under 10 seconds</div>
          </div>

          <div class="kpis" role="list" aria-label="Objectives">
            <div class="kpi" role="listitem">
              <b>Fast recipe creation</b>
              <span>Generate kitchen-ready recipes quickly (goal: under 10 seconds). [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</span>
            </div>
            <div class="kpi" role="listitem">
              <b>Clear nutrition info</b>
              <span>Show calories + macro estimates for transparency. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</span>
            </div>
            <div class="kpi" role="listitem">
              <b>Safe substitutions</b>
              <span>Offer 2‚Äì3 alternatives with a short rationale. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</span>
            </div>
          </div>

          <div class="divider"></div>

          <div class="section-title">
            <h3>Problem statement</h3>
          </div>
          <p class="subtitle" style="margin:0">
            Home cooks lack quick, personalized recipe suggestions that adapt to their ingredients,
            dietary needs, cultural preferences, and nutrition goals. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)
          </p>
        </div>
      </div>

      <div class="card">
        <div class="pad">
          <div class="section-title" style="margin-top:0">
            <h3>How it works (system flow)</h3>
            <p>Mirrors the proposed pipeline from your slides. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</p>
          </div>

          <div class="box">
            <ol>
              <li><b>Input Capture</b> ‚Äî pantry items, dietary needs, calorie goals, cuisine preference, prep time. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li><b>Ingredient Normalization</b> ‚Äî standardize inputs + add common staples. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li><b>Recipe Generator</b> ‚Äî title, servings, calories/macros, exact quantities, 4‚Äì6 steps. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li><b>Nutrition Balancer</b> ‚Äî portion tweaks & swaps to meet goals. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li><b>Constraint-Aware Substitution</b> ‚Äî safe alternatives with rationale. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li><b>User Output</b> ‚Äî recipe card + quick tips (timing, plating, storage). [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li><b>Feedback Loop</b> ‚Äî learns from ratings to improve future suggestions. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
            </ol>
            <p class="note">
              Note: This is a front-end prototype; nutrition numbers are estimates (not medical advice).
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- DEMO -->
    <section id="demo" class="grid2" aria-label="AI recipe demo">
      <div class="card">
        <div class="pad">
          <div class="section-title" style="margin-top:0">
            <h3>‚ú® Try PantryPilot AI</h3>
            <p>Enter what you have ‚Äî it generates a recipe + nutrition + substitutions + tips. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</p>
          </div>

          <div class="form" aria-label="Recipe input form">
            <div>
              <label for="items">Pantry items (comma separated)</label>
              <textarea id="items" placeholder="e.g., rice, tomato, onion, paneer, spinach, garlic"></textarea>
              <div class="hint">Tip: Add 6‚Äì10 items. We auto-add basic staples (salt, oil, water). [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</div>
            </div>

            <div class="row">
              <div>
                <label for="diet">Dietary needs</label>
                <select id="diet">
                  <option value="none">None</option>
                  <option value="vegetarian">Vegetarian</option>
                  <option value="vegan">Vegan</option>
                  <option value="glutenfree">Gluten-free</option>
                  <option value="lactosefree">Lactose-free</option>
                  <option value="lowcarb">Low-carb</option>
                  <option value="highprotein">High-protein</option>
                </select>
              </div>
              <div>
                <label for="cuisine">Cuisine preference</label>
                <select id="cuisine">
                  <option value="auto">Auto (from ingredients)</option>
                  <option value="indian">Indian</option>
                  <option value="italian">Italian</option>
                  <option value="mexican">Mexican</option>
                  <option value="chinese">Chinese</option>
                  <option value="mediterranean">Mediterranean</option>
                </select>
              </div>
            </div>

            <div class="row">
              <div>
                <label for="time">Prep time (minutes)</label>
                <input id="time" type="number" min="5" max="180" value="25" />
              </div>
              <div>
                <label for="servings">Servings</label>
                <input id="servings" type="number" min="1" max="10" value="2" />
              </div>
            </div>

            <div class="row">
              <div>
                <label for="calGoal">Calories target (per serving)</label>
                <input id="calGoal" type="number" min="150" max="1200" value="450" />
              </div>
              <div>
                <label for="spice">Spice level</label>
                <select id="spice">
                  <option value="mild">Mild</option>
                  <option value="medium" selected>Medium</option>
                  <option value="hot">Hot</option>
                </select>
              </div>
            </div>

            <div class="divider"></div>

            <div style="display:flex;gap:10px;flex-wrap:wrap">
              <button class="btn primary" id="generateBtn">‚ö° Generate Recipe</button>
              <button class="btn" id="randomBtn">üé≤ Fill Sample</button>
              <button class="btn" id="resetBtn">üßπ Reset</button>
            </div>

            <div class="calib">
              <div class="calib-left">
                <div class="badge" title="Local learning stored in your browser">
                  üß† <strong>Calibration</strong> via feedback loop
                </div>
                <div class="seg" role="tablist" aria-label="Calibration mode">
                  <button id="modeTaste" class="active" role="tab" aria-selected="true">üòã Taste-first</button>
                  <button id="modeBalanced" role="tab" aria-selected="false">‚öñÔ∏è Balanced</button>
                  <button id="modeFitness" role="tab" aria-selected="false">üèãÔ∏è Fitness-first</button>
                </div>
              </div>
              <div class="mini" id="calibReadout">Profile: Balanced ‚Ä¢ Learned likes: 0</div>
            </div>

          </div>
        </div>
      </div>

      <div class="card">
        <div class="pad">
          <div class="section-title" style="margin-top:0">
            <h3>üßæ Your Recipe Card</h3>
            <p>Includes steps, nutrition estimate, substitutions, and quick tips. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</p>
          </div>

          <div id="output" class="recipe" aria-live="polite">
            <div class="box">
              <p style="margin:0;color:var(--muted);line-height:1.55">
                Enter your pantry items and hit <b>Generate Recipe</b>.  
                This prototype simulates a generative AI pipeline with nutrition balancing and feedback calibration. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT / OBJECTIVES / REFS -->
    <section class="grid2" style="margin-top:18px">
      <div class="card">
        <div class="pad">
          <div class="section-title" style="margin-top:0">
            <h3>Objectives</h3>
            <p>These are the targets listed in your presentation. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</p>
          </div>
          <div class="box">
            <ul>
              <li>Generate kitchen-ready recipes quickly (goal: <b>under 10 seconds</b>). [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li>Ensure nutritional clarity with calories and macro display. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li>Provide 2‚Äì3 safe substitutions with rationale. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li>Reduce food waste by maximizing pantry use and offering storage tips. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
            </ul>
          </div>
          <p class="note">
            This site is designed as an efficient, client-side demo you can later connect to a real AI model/API.
          </p>
        </div>
      </div>

      <div class="card refs">
        <div class="pad">
          <div class="section-title" style="margin-top:0">
            <h3>References (from slides)</h3>
            <p>Included exactly as listed. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</p>
          </div>
          <div class="box">
            <ul>
              <li>Recipe Generation with Neural Language Models ‚Äî Kusner & Hern√°ndez-Lobato (2016): <a href="https://arxiv.org/abs/1606.03498" target="_blank" rel="noreferrer">arXiv:1606.03498</a> [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li>Ingredient substitution / ingredient networks ‚Äî Teng, Lin, Adamic (2012): <a href="https://dl.acm.org/doi/10.1145/2187836.2187953" target="_blank" rel="noreferrer">ACM DOI</a> [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li>Nutritional estimation & cross-modal cooking embeddings ‚Äî Salvador et al. (2017): <a href="https://arxiv.org/abs/1703.03924" target="_blank" rel="noreferrer">arXiv:1703.03924</a> [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
              <li>Personalization in Food-Tech AI ‚Äî Yang et al. (2019): <a href="https://dl.acm.org/doi/10.1145/3343031.3350905" target="_blank" rel="noreferrer">ACM DOI</a> [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)</li>
            </ul>
          </div>
          <p class="note">
            Footer note: Always verify allergies and medical nutrition needs with a professional.
          </p>
        </div>
      </div>
    </section>

    <div style="text-align:center;margin-top:22px;color:var(--faint);font-size:12px">
      Built for your project: <b>Generative AI-powered kitchen companion</b>. [1](https://mujmanipal-my.sharepoint.com/personal/abhay_2427030617_muj_manipal_edu/_layouts/15/Doc.aspx?sourcedoc=%7B44FA4BF2-A138-455C-878E-DC8458DCDA19%7D&file=Home%20cooks%20lack%20fast,%20personalized%20recipe%20suggestions%20that%20adapt%20to%20their%20ingredients,%20dietary%20needs,%20cultural%20preferences,%20and%20nutrition%20goals.pptx.pptx&action=edit&mobileredirect=true)
      ‚Ä¢ <a href="#top" style="text-decoration:underline;text-decoration-color:rgba(255,255,255,.35)">Back to top</a>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    /******************************************************************
     * PantryPilot AI ‚Äî Front-end prototype
     * - Pantry-aware generation
     * - Diet constraints
     * - Substitutions with rationale
     * - Nutrition estimates + "balancer"
     * - Feedback loop calibration (localStorage)
     ******************************************************************/

    // ---------- Helpers ----------
    const $ = (sel) => document.querySelector(sel);
    const toastEl = $("#toast");
    const showToast = (msg) => {
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(() => toastEl.classList.remove("show"), 2200);
    };

    const clamp = (n, a, b) => Math.max(a, Math.min(b, n));
    const round = (n, d=0) => {
      const p = Math.pow(10, d);
      return Math.round(n * p) / p;
    };
    const titleCase = (s) => s.replace(/\w\S*/g, t => t[0].toUpperCase() + t.slice(1).toLowerCase());

    // Normalize user pantry input into a de-duplicated list
    const normalizeItems = (raw) => {
      const staples = ["salt", "oil", "water"]; // auto-add common staples
      const tokens = (raw || "")
        .split(/[,\n]/g)
        .map(x => x.trim().toLowerCase())
        .filter(Boolean)
        .map(x => x.replace(/\s+/g, " "));
      const set = new Set([...tokens, ...staples]);
      // remove ultra-generic words
      ["some", "anything", "etc", "stuff"].forEach(x => set.delete(x));
      return [...set];
    };

    // ---------- Lightweight "Knowledge Base" ----------
    // Minimal nutrition map (per 100g) ‚Äî estimates for demo purposes only
    const NUTRITION = {
      "rice":        { kcal: 130, p: 2.4, c: 28.0, f: 0.3 },
      "pasta":       { kcal: 131, p: 5.0, c: 25.0, f: 1.1 },
      "bread":       { kcal: 265, p: 9.0, c: 49.0, f: 3.2 },
      "potato":      { kcal: 77,  p: 2.0, c: 17.0, f: 0.1 },
      "tomato":      { kcal: 18,  p: 0.9, c: 3.9,  f: 0.2 },
      "onion":       { kcal: 40,  p: 1.1, c: 9.3,  f: 0.1 },
      "garlic":      { kcal: 149, p: 6.4, c: 33.0, f: 0.5 },
      "spinach":     { kcal: 23,  p: 2.9, c: 3.6,  f: 0.4 },
      "carrot":      { kcal: 41,  p: 0.9, c: 9.6,  f: 0.2 },
      "capsicum":    { kcal: 31,  p: 1.0, c: 6.0,  f: 0.3 },
      "bell pepper": { kcal: 31,  p: 1.0, c: 6.0,  f: 0.3 },
      "mushroom":    { kcal: 22,  p: 3.1, c: 3.3,  f: 0.3 },
      "paneer":      { kcal: 265, p: 18.0,c: 3.0,  f: 20.0},
      "tofu":        { kcal: 76,  p: 8.0, c: 1.9,  f: 4.8 },
      "chicken":     { kcal: 165, p: 31.0,c: 0.0,  f: 3.6 },
      "egg":         { kcal: 155, p: 13.0,c: 1.1,  f: 11.0},
      "yogurt":      { kcal: 61,  p: 3.5, c: 4.7,  f: 3.3 },
      "milk":        { kcal: 42,  p: 3.4, c: 5.0,  f: 1.0 },
      "cheese":      { kcal: 402, p: 25.0,c: 1.3,  f: 33.0},
      "chickpeas":   { kcal: 164, p: 9.0, c: 27.0, f: 2.6 },
      "lentils":     { kcal: 116, p: 9.0, c: 20.0, f: 0.4 },
      "beans":       { kcal: 127, p: 8.7, c: 22.8, f: 0.5 },
      "olive oil":   { kcal: 884, p: 0.0, c: 0.0,  f: 100.0},
      "oil":         { kcal: 884, p: 0.0, c: 0.0,  f: 100.0},
      "butter":      { kcal: 717, p: 0.9, c: 0.1,  f: 81.0},
      "salt":        { kcal: 0,   p: 0.0, c: 0.0,  f: 0.0 },
      "water":       { kcal: 0,   p: 0.0, c: 0.0,  f: 0.0 },
      "lemon":       { kcal: 29,  p: 1.1, c: 9.3,  f: 0.3 },
      "ginger":      { kcal: 80,  p: 1.8, c: 18.0, f: 0.8 },
      "cumin":       { kcal: 375, p: 18.0,c: 44.0, f: 22.0},
      "turmeric":    { kcal: 312, p: 9.7, c: 67.0, f: 3.3 },
      "chilli":      { kcal: 40,  p: 2.0, c: 9.0,  f: 0.4 },
      "chili":       { kcal: 40,  p: 2.0, c: 9.0,  f: 0.4 }
    };

    // Substitution map with rationale (constraint-aware)
    const SUBS = {
      "paneer": [
        { item: "tofu", why: "Similar texture, works well for high-protein or lactose-free meals." },
        { item: "chickpeas", why: "Adds protein + bite; great for vegan versions." }
      ],
      "milk": [
        { item: "oat milk", why: "Dairy-free swap; mild taste for sauces." },
        { item: "soy milk", why: "Higher protein dairy-free option." }
      ],
      "yogurt": [
        { item: "coconut yogurt", why: "Dairy-free, good for marinades." },
        { item: "lemon + water", why: "Quick tang substitute for sauces (lighter)." }
      ],
      "chicken": [
        { item: "tofu", why: "Vegan/vegetarian-friendly protein alternative." },
        { item: "mushroom", why: "Umami-rich option for similar savory depth." }
      ],
      "egg": [
        { item: "tofu scramble", why: "High-protein vegan alternative." },
        { item: "chickpea flour batter", why: "Works as binder in many dishes." }
      ],
      "wheat flour": [
        { item: "rice flour", why: "Gluten-free alternative for thickening/batter." },
        { item: "corn flour", why: "Gluten-free thickener; crisp coatings." }
      ]
    };

    // Cuisine flavor packs
    const CUISINE = {
      indian: {
        signature: ["cumin", "turmeric", "ginger", "garlic"],
        garnish: ["lemon", "coriander"],
        methods: ["tadka", "saut√©", "simmer"]
      },
      italian: {
        signature: ["garlic", "olive oil", "tomato"],
        garnish: ["cheese", "basil"],
        methods: ["saut√©", "simmer", "toss"]
      },
      mexican: {
        signature: ["onion", "garlic", "chili"],
        garnish: ["lemon", "cheese"],
        methods: ["saut√©", "toast", "mix"]
      },
      chinese: {
        signature: ["garlic", "ginger", "oil"],
        garnish: ["spring onion", "sesame"],
        methods: ["stir-fry", "saut√©", "steam"]
      },
      mediterranean: {
        signature: ["olive oil", "lemon", "garlic"],
        garnish: ["yogurt", "herbs"],
        methods: ["roast", "saut√©", "mix"]
      }
    };

    // Diet constraints: disallowed ingredients
    const DIET_BLOCKLIST = {
      vegetarian: ["chicken", "fish", "mutton", "beef"],
      vegan: ["chicken", "fish", "mutton", "beef", "paneer", "milk", "yogurt", "cheese", "egg", "butter", "ghee"],
      glutenfree: ["wheat", "bread", "pasta", "maida", "flour"],
      lactosefree: ["paneer", "milk", "yogurt", "cheese", "butter", "ghee"],
      lowcarb: ["rice", "pasta", "bread", "potato"],
      highprotein: [] // not a blocklist, used by balancer
    };

    // ---------- Calibration (feedback loop) ----------
    const STORE_KEY = "pantrypilot_profile_v1";
    const defaultProfile = {
      mode: "balanced", // taste | balanced | fitness
      likes: 0,
      dislikes: 0,
      favoredCuisine: null,
      spiceBias: 0, // -1 mild ... +1 hot
      proteinBias: 0 // increases protein focus when positive
    };

    const loadProfile = () => {
      try{
        const v = JSON.parse(localStorage.getItem(STORE_KEY) || "null");
        return v && typeof v === "object" ? { ...defaultProfile, ...v } : { ...defaultProfile };
      }catch{
        return { ...defaultProfile };
      }
    };
    const saveProfile = (p) => localStorage.setItem(STORE_KEY, JSON.stringify(p));

    let profile = loadProfile();

    // ---------- Theme ----------
    const THEME_KEY = "pantrypilot_theme";
    const applyTheme = (t) => {
      document.documentElement.setAttribute("data-theme", t);
      localStorage.setItem(THEME_KEY, t);
    };
    const initTheme = () => {
      const saved = localStorage.getItem(THEME_KEY);
      if(saved){ applyTheme(saved); return; }
      // default: dark
      applyTheme("dark");
    };

    // ---------- "AI" Generation Logic ----------
    const guessCuisine = (items) => {
      // If user has typical Indian spices/ingredients, lean Indian
      const has = (k) => items.includes(k);
      if(has("turmeric") || has("cumin") || has("paneer") || has("lentils")) return "indian";
      if(has("pasta") || has("olive oil") || has("cheese")) return "italian";
      if(has("beans") || has("chili") || has("capsicum")) return "mexican";
      if(has("ginger") && has("garlic") && (has("rice") || has("noodles"))) return "chinese";
      if(has("lemon") && has("olive oil") && (has("yogurt") || has("chickpeas"))) return "mediterranean";
      // fallback using profile preference
      return profile.favoredCuisine || "indian";
    };

    const pickMain = (items, diet) => {
      const blocked = new Set(DIET_BLOCKLIST[diet] || []);
      // candidate proteins/carbs/veg
      const proteins = ["chicken", "paneer", "tofu", "egg", "chickpeas", "lentils", "beans", "yogurt"];
      const carbs = ["rice", "pasta", "bread", "potato"];
      const veg = ["spinach", "tomato", "onion", "mushroom", "carrot", "capsicum", "bell pepper"];

      const inItems = (arr) => arr.filter(x => items.includes(x) && !blocked.has(x));
      const p = inItems(proteins);
      const c = inItems(carbs);
      const v = inItems(veg);

      // Fitness mode prefers protein
      if(profile.mode === "fitness" && p.length) return p[0];
      // Taste mode: choose richer protein if available
      if(profile.mode === "taste" && (items.includes("paneer") && !blocked.has("paneer"))) return "paneer";
      if(p.length) return p[0];
      if(c.length) return c[0];
      return v[0] || items[0] || "vegetables";
    };

    const methodFromTime = (minutes, cuisine) => {
      const fast = minutes <= 20;
      const m = (CUISINE[cuisine]?.methods || ["saut√©","simmer","mix"]);
      if(fast) return m.includes("stir-fry") ? "stir-fry" : (m[0] || "saut√©");
      if(minutes <= 35) return m.includes("simmer") ? "simmer" : (m[1] || "simmer");
      return m.includes("roast") ? "roast" : (m[2] || "simmer");
    };

    const spiceAdjust = (spiceSel) => {
      const base = spiceSel === "mild" ? -0.5 : spiceSel === "hot" ? 0.7 : 0.0;
      return clamp(base + profile.spiceBias, -1, 1);
    };

    // Build ingredient quantities (simple heuristic)
    const buildIngredients = (items, servings, cuisine, diet, spiceSel) => {
      const blocked = new Set(DIET_BLOCKLIST[diet] || []);
      const cleaned = items.filter(x => !blocked.has(x));

      // Ensure signature spices if missing (tiny amounts)
      const sig = (CUISINE[cuisine]?.signature || []).filter(s => !cleaned.includes(s));
      const add = sig.slice(0, 2); // only add up to 2 extra spices for simplicity
      const finalItems = [...new Set([...cleaned, ...add])];

      const qty = [];
      const sp = spiceAdjust(spiceSel);

      const perServeBase = {
        veg: 120,
        protein: 120,
        carb: 140
      };

      const isProtein = (x) => ["paneer","tofu","chicken","egg","chickpeas","lentils","beans","yogurt"].includes(x);
      const isCarb = (x) => ["rice","pasta","bread","potato"].includes(x);

      finalItems.forEach(it => {
        if(it === "salt") return qty.push({ it, q: "to taste" });
        if(it === "water") return qty.push({ it, q: "as needed" });
        if(it === "oil" || it === "olive oil") return qty.push({ it, q: `${Math.max(1, Math.round(servings*1.2))} tbsp` });

        if(isProtein(it)) qty.push({ it, q: `${Math.round(perServeBase.protein * servings * (profile.mode==="fitness"?1.1:1.0))} g` });
        else if(isCarb(it)) qty.push({ it, q: `${Math.round(perServeBase.carb * servings * (diet==="lowcarb"?0.6:1.0))} g` });
        else if(["garlic","ginger","cumin","turmeric"].includes(it)) qty.push({ it, q: `${Math.max(1, Math.round(servings))} tsp` });
        else if(it === "chilli" || it === "chili") qty.push({ it, q: sp <= -0.3 ? "¬Ω tsp" : sp >= 0.5 ? "1¬Ω tsp" : "1 tsp" });
        else qty.push({ it, q: `${Math.round(perServeBase.veg * servings * 0.55)} g` });
      });

      return qty;
    };

    // Nutrition estimate using NUTRITION map (very approximate)
    const estimateNutrition = (ingredients, servings) => {
      let tot = { kcal:0, p:0, c:0, f:0 };
      const parseGrams = (q) => {
        const m = String(q).match(/(\d+)\s*g/i);
        return m ? parseInt(m[1],10) : null;
      };
      const parseTbspOil = (q) => {
        // approx 13.5g per tbsp oil
        const m = String(q).match(/(\d+)\s*tbsp/i);
        return m ? parseInt(m[1],10) * 13.5 : null;
      };
      const parseTsp = (q) => {
        // rough: 1 tsp spices ~ 2-3g, use 2.5g
        const m = String(q).match(/(\d+)\s*tsp/i);
        return m ? parseInt(m[1],10) * 2.5 : null;
      };

      ingredients.forEach(({it,q}) => {
        const key = it.toLowerCase();
        const n = NUTRITION[key];
        if(!n) return;
        let grams = parseGrams(q);
        if(grams == null) grams = parseTbspOil(q);
        if(grams == null) grams = parseTsp(q);
        if(grams == null) return;

        const factor = grams / 100.0;
        tot.kcal += n.kcal * factor;
        tot.p += n.p * factor;
        tot.c += n.c * factor;
        tot.f += n.f * factor;
      });

      const per = {
        kcal: tot.kcal / servings,
        p: tot.p / servings,
        c: tot.c / servings,
        f: tot.f / servings
      };
      return { total: tot, perServing: per };
    };

    // Nutrition "balancer": tries to nudge recipe toward calorie goal
    const balanceToCalories = (ingredients, servings, calGoal, diet) => {
      // Make a shallow copy
      const out = ingredients.map(x => ({...x}));
      const est = estimateNutrition(out, servings);
      let kcal = est.perServing.kcal || 0;

      // If very off, adjust carb/protein portions
      const scaleDown = (itemList, factor) => {
        itemList.forEach(name => {
          const idx = out.findIndex(x => x.it === name);
          if(idx >= 0){
            const m = String(out[idx].q).match(/(\d+)\s*g/i);
            if(m){
              const g = parseInt(m[1],10);
              out[idx].q = `${Math.round(g * factor)} g`;
            }
          }
        });
      };

      // identify common calorie drivers
      const carbItems = ["rice","pasta","bread","potato"];
      const fatItems  = ["oil","olive oil","butter","ghee","cheese"];
      const proteinItems = ["paneer","tofu","chicken","egg","chickpeas","lentils","beans"];

      // Avoid aggressive changes: max 20% change
      const diff = calGoal - kcal;
      if(Math.abs(diff) < 60) return { ingredients: out, note: "Already close to your calorie target." };

      if(diff < 0){
        // Too high: reduce fats first, then carbs
        scaleDown(fatItems, 0.85);
        let est2 = estimateNutrition(out, servings);
        if(est2.perServing.kcal - calGoal > 40) scaleDown(carbItems, diet==="lowcarb"?0.75:0.85);

        return { ingredients: out, note: "Balanced by slightly reducing high-calorie portions (fats/carbs)." };
      }else{
        // Too low: bump protein (fitness) or carbs (taste)
        if(profile.mode === "fitness" || diet === "highprotein"){
          scaleDown(proteinItems, 1.12);
        }else{
          scaleDown(carbItems, 1.12);
        }
        return { ingredients: out, note: "Balanced by slightly increasing portions to match your calorie goal." };
      }
    };

    const buildSteps = (main, cuisine, method, minutes, spiceSel) => {
      const sp = spiceAdjust(spiceSel);
      const heat = sp <= -0.3 ? "low" : sp >= 0.5 ? "high" : "medium";
      const t1 = Math.max(2, Math.round(minutes * 0.18));
      const t2 = Math.max(4, Math.round(minutes * 0.28));
      const t3 = Math.max(5, Math.round(minutes * 0.34));

      const style = cuisine === "indian"
        ? [
            `Heat oil on ${heat} flame. Add cumin/ginger/garlic (if available) and saut√© for ${t1} min.`,
            `Add onions/tomatoes/veggies. Cook until softened (${t2} min).`,
            `Add your main ingredient (${main}). Season with salt and spices; simmer ${t3} min.`,
            `Adjust texture with water as needed. Finish with lemon/herbs. Rest 1 min.`,
            `Serve hot. Optional: yogurt/cheese garnish if it matches your diet.`
          ]
        : cuisine === "italian"
        ? [
            `Warm olive oil; saut√© garlic/onion for ${t1} min.`,
            `Add tomatoes/veg; simmer ${t2} min until saucy.`,
            `Add ${main}; toss gently. Cook ${t3} min.`,
            `Season and finish with lemon/herbs; add cheese if allowed.`,
            `Plate and serve immediately.`
          ]
        : cuisine === "chinese"
        ? [
            `Heat oil on ${heat}. Add ginger/garlic and stir-fry for ${t1} min.`,
            `Add veggies; stir-fry ${t2} min.`,
            `Add ${main}; cook ${t3} min, keeping it moving.`,
            `Season with salt; adjust with water for a light sauce.`,
            `Serve hot; garnish if available.`
          ]
        : [
            `Heat oil on ${heat}. Saut√© aromatics for ${t1} min.`,
            `Add veggies; cook ${t2} min.`,
            `Add ${main}; cook ${t3} min and season well.`,
            `Finish with lemon/herbs; rest briefly.`,
            `Serve and enjoy.`
          ];

      // Keep to 4‚Äì6 clear steps (as in slides)
      return style.slice(0, 5);
    };

    const buildTitle = (main, cuisine) => {
      const names = {
        indian: ["Masala", "Tadka", "Khichdi-Style", "Curry"],
        italian: ["Sugo", "Skillet", "Pomodoro", "Toss"],
        mexican: ["Salsa", "Skillet", "Bowl", "Picante"],
        chinese: ["Stir-Fry", "Wok", "Quick", "Steam"],
        mediterranean: ["Zesty", "Herb", "Lemon", "Bowl"]
      };
      const pool = names[cuisine] || ["Quick", "Smart", "Pantry"];
      const a = pool[Math.floor(Math.random()*pool.length)];
      const b = pool[Math.floor(Math.random()*pool.length)];
      const accent = a === b ? a : `${a} ${b}`;
      return `${accent} ${titleCase(main)} (PantryPilot)`;
    };

    const getSubstitutions = (items, diet) => {
      const blocked = new Set(DIET_BLOCKLIST[diet] || []);
      const found = [];
      items.forEach(it => {
        if(SUBS[it]){
          const candidates = SUBS[it]
            .filter(s => !blocked.has(s.item))
            .slice(0, 2);
          candidates.forEach(s => found.push({from: it, to: s.item, why: s.why}));
        }
      });
      // If none, suggest generic swaps based on diet
      if(!found.length){
        if(diet === "vegan") found.push({from:"dairy/eggs", to:"tofu/chickpeas", why:"Plant proteins keep the dish hearty."});
        if(diet === "glutenfree") found.push({from:"wheat flour", to:"rice flour", why:"Gluten-free thickening alternative."});
      }
      return found.slice(0, 3);
    };

    const quickTips = (items, minutes) => {
      const tips = [];
      tips.push(minutes <= 20
        ? "Timing: Prep everything first (mise en place) to keep it under 20 minutes."
        : "Timing: Start with chopping; cooking becomes faster once aromatics are ready.");
      tips.push("Plating: Add a fresh squeeze of lemon or herbs at the end for brightness.");
      tips.push(items.includes("spinach") || items.includes("tomato")
        ? "Storage: Cool quickly, refrigerate in an airtight box; reheat gently."
        : "Storage: Portion leftovers to avoid waste; label with date.");
      return tips.slice(0,3);
    };

    // ---------- Render ----------
    const renderRecipe = (model) => {
      const {
        title, cuisine, method, servings, minutes,
        ingredients, steps, nutrition, subs, tips, balanceNote
      } = model;

      const per = nutrition?.perServing || {kcal:0,p:0,c:0,f:0};
      const kcal = Math.max(0, per.kcal || 0);

      const badge = (label, value) =>
        `<span class="badge">${label} <strong>${value}</strong></span>`;

      $("#output").innerHTML = `
        <div class="box">
          <div class="recipe-header">
            <div>
              <h4 style="margin:0 0 10px;color:var(--muted);text-transform:uppercase;letter-spacing:.2px;font-size:12px">Generated Recipe</h4>
              <h3 class="recipe-title">${title}</h3>
              <div class="meta">
                ${badge("üåç Cuisine:", titleCase(cuisine))}
                ${badge("üç≥ Method:", titleCase(method))}
                ${badge("‚è±Ô∏è Time:", `${minutes} min`)}
                ${badge("üçΩÔ∏è Servings:", `${servings}`)}
              </div>
            </div>
            <div class="badge" title="Nutrition estimate">
              üî• <strong>${round(kcal)}</strong> kcal/serving
            </div>
          </div>
          <p class="note" style="margin-top:10px">
            ${balanceNote ? "‚öñÔ∏è " + balanceNote : "‚öôÔ∏è Nutrition balancer is ready."}
            <br><span style="opacity:.9">Nutrition values are estimates for demo purposes.</span>
          </p>
        </div>

        <div class="cols">
          <div class="box">
            <h4>Ingredients (with quantities)</h4>
            <ul>
              ${ingredients.map(x => `<li><b>${titleCase(x.it)}</b> ‚Äî ${x.q}</li>`).join("")}
            </ul>
          </div>

          <div class="box">
            <h4>Nutrition (estimated per serving)</h4>
            <ul>
              <li><b>Calories</b> ‚Äî ${round(per.kcal)} kcal</li>
              <li><b>Protein</b> ‚Äî ${round(per.p,1)} g</li>
              <li><b>Carbs</b> ‚Äî ${round(per.c,1)} g</li>
              <li><b>Fat</b> ‚Äî ${round(per.f,1)} g</li>
            </ul>
            <p class="note">Tip: For accuracy, connect this UI to a verified nutrition database/API later.</p>
          </div>
        </div>

        <div class="cols">
          <div class="box">
            <h4>Steps (clear, beginner-friendly)</h4>
            <ol>
              ${steps.map(s => `<li>${s}</li>`).join("")}
            </ol>
          </div>

          <div class="box">
            <h4>Substitutions (constraint-aware)</h4>
            ${subs.length ? `
              <ul>
                ${subs.map(s => `<li><b>${titleCase(s.from)}</b> ‚Üí ${titleCase(s.to)} <span style="color:var(--faint)">(${s.why})</span></li>`).join("")}
              </ul>
            ` : `<p style="margin:0;color:var(--muted)">No substitutions needed ‚Äî your pantry fits well.</p>`}
            <div class="divider"></div>
            <h4>Quick tips (timing ‚Ä¢ plating ‚Ä¢ storage)</h4>
            <ul>
              ${tips.map(t => `<li>${t}</li>`).join("")}
            </ul>
          </div>
        </div>

        <div class="box">
          <h4>Calibrate the AI (feedback loop)</h4>
          <p style="margin:0 0 10px;color:var(--muted);line-height:1.5">
            Rate this suggestion ‚Äî the demo will adapt your future results locally (browser storage).
          </p>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn" id="likeBtn">üëç Like</button>
            <button class="btn" id="dislikeBtn">üëé Dislike</button>
            <button class="btn" id="copyBtn">üìã Copy Recipe</button>
          </div>
        </div>
      `;

      // Bind calibration buttons
      $("#likeBtn").onclick = () => {
        profile.likes += 1;
        profile.favoredCuisine = cuisine;
        // slight bias toward user's chosen spice
        profile.spiceBias = clamp(profile.spiceBias + 0.08, -0.4, 0.6);
        profile.proteinBias = clamp(profile.proteinBias + (profile.mode==="fitness" ? 0.10 : 0.04), 0, 0.7);
        saveProfile(profile);
        updateCalibReadout();
        showToast("Saved üëç ‚Äî future recipes will align better.");
      };
      $("#dislikeBtn").onclick = () => {
        profile.dislikes += 1;
        profile.spiceBias = clamp(profile.spiceBias - 0.06, -0.6, 0.6);
        saveProfile(profile);
        updateCalibReadout();
        showToast("Saved üëé ‚Äî adjusting preferences.");
      };
      $("#copyBtn").onclick = async () => {
        const text =
`${title}
Cuisine: ${cuisine} | Method: ${method} | Time: ${minutes} min | Servings: ${servings}

Ingredients:
${ingredients.map(x => `- ${titleCase(x.it)} ‚Äî ${x.q}`).join("\n")}

Steps:
${steps.map((s,i)=>`${i+1}. ${s}`).join("\n")}

Nutrition (per serving, estimate):
Calories: ${round(per.kcal)} kcal
Protein: ${round(per.p,1)} g | Carbs: ${round(per.c,1)} g | Fat: ${round(per.f,1)} g
